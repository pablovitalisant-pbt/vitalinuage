# Especificación Slice 09.2: Consultas Clínicas (Evolución)

## Contexto
Permitir a los médicos registrar la evolución clínica de los pacientes mediante notas de consulta. Cada consulta queda asociada a un paciente y a un médico (owner), garantizando la trazabilidad y la privacidad.

## Alcance
- Backend: Modelos DB, Esquemas Pydantic, Endpoints API.
- Frontend: Contratos TS.
- Seguridad: Validación de `owner_id`.

## Modelo de Datos (Contrato)

### Entidad: `ClinicalConsultation`
| Campo | Tipo | Requerido | Descripción |
|---|---|---|---|
| id | Integer | Sí (Lectura) | Identificador único autogenerado. |
| patient_id | Integer | Sí | ID del paciente asociado. |
| motivo_consulta | String | Sí | Razón principal de la visita. |
| examen_fisico | String | No | Hallazgos del examen físico. |
| diagnostico | String | Sí | Diagnóstico presuntivo o definitivo. |
| plan_tratamiento | String | Sí | Indicaciones, medicamentos, conductas. |
| proxima_cita | Date/Datetime | No | Fecha sugerida para control. |
| created_at | Datetime | Sí (Lectura) | Fecha de creación. |
| updated_at | Datetime | Sí (Lectura) | Fecha de última edición. |

## API Endpoints (`/api/pacientes/{id}/consultas`)

### 1. Crear Consulta
- **Método:** `POST`
- **URL:** `/api/pacientes/{patient_id}/consultas`
- **Body:** `ConsultationCreate` (ver esquema)
- **Respuesta:** `200 OK` con objeto `ConsultationResponse`
- **Reglas:**
    - Validar que el paciente pertenezca al médico autenticado (`owner_id`).
    - Validar campos requeridos.

### 2. Listar Consultas
- **Método:** `GET`
- **URL:** `/api/pacientes/{patient_id}/consultas`
- **Query Params:** Opional `limit`, `offset` (para futuro paging).
- **Respuesta:** `200 OK` con `List[ConsultationResponse]`
- **Reglas:**
    - Orden descendente por `created_at` (más recientes primero).
    - Filtrar por `owner_id` (Solo el médico puede ver sus consultas).

## Criterios de Aceptación
1. Esquemas Pydantic y TypeScript generados idénticos.
2. Endpoints documentados y listos para implementación (Fase B).
3. Tests de contrato definidos (aunque se implementarán en Fase B).
