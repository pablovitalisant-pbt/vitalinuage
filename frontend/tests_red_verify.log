
> vitalinuage-frontend@0.0.0 test
> jest src/context/DoctorContext.test.tsx src/components/Search.test.tsx

FAIL src/context/DoctorContext.test.tsx
  ÔùÅ DoctorContext Integration ÔÇ║ should fetch profile from API on mount

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "/api/doctor/profile", Anything

    Number of calls: 0

    Ignored nodes: comments, script, style
    <html>
      <head />
      <body>
        <div>
          <div>
            <span
              data-testid="prof-name"
            />
            <span
              data-testid="prof-spec"
            />
          </div>
        </div>
      </body>
    </html>

      48 |         // Red Phase: Expects API call (currently not implemented in component)
      49 |         await waitFor(() => {
    > 50 |             expect(global.fetch).toHaveBeenCalledWith(
         |                                  ^
      51 |                 expect.stringContaining('/api/doctor/profile'),
      52 |                 expect.anything()
      53 |             );

      at src/context/DoctorContext.test.tsx:50:34
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ÔùÅ DoctorContext Integration ÔÇ║ should degrade gracefully to "Dr. Vitali" on 500 error

    expect(element).toHaveTextContent()

    Expected element to have text content:
      Dr. Vitali
    Received:


    Ignored nodes: comments, script, style
    <html>
      <head />
      <body>
        <div>
          <div>
            <span
              data-testid="prof-name"
            />
            <span
              data-testid="prof-spec"
            />
          </div>
        </div>
      </body>
    </html>

      74 |         await waitFor(() => {
      75 |             // In Red Phase, just ensuring it renders 
    > 76 |             expect(screen.getByTestId('prof-name')).toHaveTextContent('Dr. Vitali');
         |                                                     ^
      77 |         });
      78 |     });
      79 | });

      at src/context/DoctorContext.test.tsx:76:53
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

FAIL src/components/Search.test.tsx
  ÔùÅ Search Component Integration ÔÇ║ should call Search API if query length >= 3

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "/api/pacientes/search?q=Test", Anything

    Number of calls: 0

    Ignored nodes: comments, script, style
    <html>
      <head />
      <body>
        <div>
          <div
            class="min-h-screen bg-white flex flex-col items-center pt-[20vh] font-sans px-4"
          >
            <h1
              class="text-4xl font-light text-slate-800 mb-8 tracking-tight"
            >
              Buenas tardes
              , 
              <span
                class="font-semibold text-[#1e3a8a]"
              >
                Dr. Vitali
              </span>
            </h1>
            <div
              class="w-full max-w-2xl relative"
            >
              <form
                class="relative group"
              >
                <div
                  class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"
                >
                  <svg
                    class="lucide lucide-search h-5 w-5 text-gray-400 group-focus-within:text-[#1e3a8a] transition-colors"
                    fill="none"
                    height="24"
                    stroke="currentColor"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    viewBox="0 0 24 24"
                    width="24"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <circle
                      cx="11"
                      cy="11"
                      r="8"
                    />
                    <path
                      d="m21 21-4.3-4.3"
                    />
                  </svg>
                </div>
                <input
                  autocomplete="off"
                  class="w-full pl-12 pr-4 py-3.5 rounded-full border border-gray-200 shadow-sm focus:shadow-md focus:border-transparent focus:ring-2 focus:ring-blue-100 outline-none transition-all text-gray-800 text-lg"
                  name="query"
                  placeholder="Buscar paciente por nombre o DNI..."
                  type="text"
                />
                <button
                  class="hidden"
                  type="submit"
                />
              </form>
            </div>
            <div
              class="w-full max-w-2xl mt-8"
            />
          </div>
        </div>
      </body>
    </html>

      60 |         // Red Phase: Fails because fetch logic is not implemented
      61 |         await waitFor(() => {
    > 62 |             expect(global.fetch).toHaveBeenCalledWith(
         |                                  ^
      63 |                 expect.stringContaining('/api/pacientes/search?q=Test'),
      64 |                 expect.anything()
      65 |             );

      at src/components/Search.test.tsx:62:34
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ÔùÅ Search Component Integration ÔÇ║ should show loading state

    Unable to find an element with the text: /buscando/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    <body>
      <div>
        <div
          class="min-h-screen bg-white flex flex-col items-center pt-[20vh] font-sans px-4"
        >
          <h1
            class="text-4xl font-light text-slate-800 mb-8 tracking-tight"
          >
            Buenas tardes
            , 
            <span
              class="font-semibold text-[#1e3a8a]"
            >
              Dr. Vitali
            </span>
          </h1>
          <div
            class="w-full max-w-2xl relative"
          >
            <form
              class="relative group"
            >
              <div
                class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"
              >
                <svg
                  class="lucide lucide-search h-5 w-5 text-gray-400 group-focus-within:text-[#1e3a8a] transition-colors"
                  fill="none"
                  height="24"
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                  width="24"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <circle
                    cx="11"
                    cy="11"
                    r="8"
                  />
                  <path
                    d="m21 21-4.3-4.3"
                  />
                </svg>
              </div>
              <input
                autocomplete="off"
                class="w-full pl-12 pr-4 py-3.5 rounded-full border border-gray-200 shadow-sm focus:shadow-md focus:border-transparent focus:ring-2 focus:ring-blue-100 outline-none transition-all text-gray-800 text-lg"
                name="query"
                placeholder="Buscar paciente por nombre o DNI..."
                type="text"
              />
              <button
                class="hidden"
                type="submit"
              />
            </form>
          </div>
          <div
            class="w-full max-w-2xl mt-8"
          />
        </div>
      </div>
    </body>

      80 |         fireEvent.change(input, { target: { value: 'LoadingCheck' } });
      81 |
    > 82 |         await waitFor(() => {
         |                      ^
      83 |             expect(screen.getByText(/buscando/i)).toBeInTheDocument();
      84 |         });
      85 |     });

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/components/Search.test.tsx:82:22)

Test Suites: 2 failed, 2 total
Tests:       4 failed, 1 passed, 5 total
Snapshots:   0 total
Time:        6.368 s
Ran all test suites matching src/context/DoctorContext.test.tsx|src/components/Search.test.tsx.
